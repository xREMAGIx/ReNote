<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docker/docker-compose" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Docker Compose | ReNote</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xremagix.github.io/renote/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xremagix.github.io/renote/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xremagix.github.io/renote/docs/docker/docker-compose"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker Compose | ReNote"><meta data-rh="true" name="description" content="Configuration files defining services, networks, and volumes for Docker applications."><meta data-rh="true" property="og:description" content="Configuration files defining services, networks, and volumes for Docker applications."><link data-rh="true" rel="icon" href="/renote/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xremagix.github.io/renote/docs/docker/docker-compose"><link data-rh="true" rel="alternate" href="https://xremagix.github.io/renote/docs/docker/docker-compose" hreflang="en"><link data-rh="true" rel="alternate" href="https://xremagix.github.io/renote/docs/docker/docker-compose" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/renote/blog/rss.xml" title="ReNote RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/renote/blog/atom.xml" title="ReNote Atom Feed"><link rel="stylesheet" href="/renote/assets/css/styles.0b6ebd38.css">
<script src="/renote/assets/js/runtime~main.3e0ac109.js" defer="defer"></script>
<script src="/renote/assets/js/main.16f042f1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/renote/"><div class="navbar__logo"><img src="/renote/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/renote/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ReNote</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/renote/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/renote/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/renote/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/crdt">CRDT</a><button aria-label="Expand sidebar category &#x27;CRDT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/renote/docs/category/docker">Docker</a><button aria-label="Collapse sidebar category &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/concept">Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/image-manipulation">Image Manipulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/container-manipulation">Container Manipulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/containerize-js-app">Containerize JavaScript application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/network-manipulcation">Network Manipulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/containerize-multi-js-app">Containerize Multi-container JavaScript application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/renote/docs/docker/docker-compose">Docker Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/renote/docs/docker/docker-file">Dockerfile</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/docusaurus">Docusaurus</a><button aria-label="Expand sidebar category &#x27;Docusaurus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/git">Git</a><button aria-label="Expand sidebar category &#x27;Git&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/github">GitHub</a><button aria-label="Expand sidebar category &#x27;GitHub&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/hygen">Hygen</a><button aria-label="Expand sidebar category &#x27;Hygen&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/libraries---packages">Libraries - Packages</a><button aria-label="Expand sidebar category &#x27;Libraries - Packages&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/markdown">Markdown</a><button aria-label="Expand sidebar category &#x27;Markdown&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/setup-sources">Setup sources</a><button aria-label="Expand sidebar category &#x27;Setup sources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/sql">SQL</a><button aria-label="Expand sidebar category &#x27;SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/tools">Tools</a><button aria-label="Expand sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/renote/docs/category/webrtc">WebRTC</a><button aria-label="Expand sidebar category &#x27;WebRTC&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/renote/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/renote/docs/category/docker"><span itemprop="name">Docker</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker Compose</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Docker Compose</h1>
<p>Configuration files defining services, networks, and volumes for Docker applications.</p>
<p>Compose is a tool for defining and <strong>running multi-container Docker applications</strong>.</p>
<p>With Compose, you use a <strong>YAML file</strong> to configure your application’s services. Then, with a single command, you create and start all the services from your configuration.</p>
<p><img loading="lazy" src="https://techmormo.com/wp-content/uploads/2022/10/diagram-1-analogy.png" alt="Docker compose diagram" class="img_ev3q"></p>
<p>Although Compose works in all environments, it&#x27;s more focused on development and testing.</p>
<p>Using Compose on <strong>a production environment is not recommended</strong> at all.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-features">Key features<a href="#key-features" class="hash-link" aria-label="Direct link to Key features" title="Direct link to Key features">​</a></h2>
<ul>
<li>Have multiple isolated environments on a single host</li>
<li>Preserve volume data when containers are created</li>
<li>Only recreate containers that have changed</li>
<li>Share variables or configurations between environments</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basics">Basics<a href="#basics" class="hash-link" aria-label="Direct link to Basics" title="Direct link to Basics">​</a></h2>
<p>We already know that this project has two containers:</p>
<p><code>notes-db</code> - A database server powered by PostgreSQL.
<code>notes-api</code> - A REST API powered by Express.js.</p>
<p>Inside <code>notes-api/api</code> directory and create a <code>Dockerfile.dev</code> file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Dockerfile.dev</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># stage one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM node:lts-alpine as builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># install dependencies for node-gyp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apk add --no-cache python make g++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./package.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># stage two</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM node:lts-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV NODE_ENV=development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USER node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN mkdir -p /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --from=builder /app/node_modules /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [ &quot;./node_modules/.bin/nodemon&quot;, &quot;--config&quot;, &quot;nodemon.json&quot;, &quot;bin/www&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the world of Compose, each container that makes up the application is known as a <strong>service</strong>.</p>
<p>The first step in composing a multi-container project is to define these services.</p>
<p>Docker Compose uses a <strong>docker-compose.yaml</strong> file to read service definitions from.</p>
<p>We will head to the notes-api directory and create a new <code>docker-compose.yaml</code> file</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">docker-compose.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version: &quot;3.8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: postgres:12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-db-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - notes-db-dev-data:/var/lib/postgresql/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            POSTGRES_DB: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            POSTGRES_PASSWORD: secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context: ./api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dockerfile: Dockerfile.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: notes-api:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-api-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_HOST: db ## same as the database service name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_DATABASE: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_PASSWORD: secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - ./api:/home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - 3000:3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notes-db-dev-data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: notes-db-dev-data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The <code>services</code> block holds the definitions for each of the services or containers in the application</p>
<ul>
<li><code>db</code> and <code>api</code> are the two services that comprise this project.</li>
</ul>
</li>
<li>
<p>Every <strong>service</strong> requires either a pre-built image or a <code>Dockerfile</code> to run a container</p>
</li>
<li>
<p>The <code>volumes</code> block defines any name volume needed by any of the services.</p>
</li>
</ul>
<p>Let&#x27;s have a closer look at the individual services.</p>
<p>The definition code for the <code>db</code> service is as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: postgres:12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_name: notes-db-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - db-data:/var/lib/postgresql/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        POSTGRES_DB: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        POSTGRES_PASSWORD: secret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The <code>image</code> key holds the image repository and tag used for this container.</p>
<ul>
<li>We&#x27;re using the postgres:12 image for running the database container.</li>
</ul>
</li>
<li>
<p>The <code>container_name</code> indicates the name of the container. By default containers are named following <code>&lt;project directory name&gt;_&lt;service name&gt;</code> syntax.</p>
<ul>
<li>You can override that using <code>container_name</code>.</li>
</ul>
</li>
<li>
<p>The <code>volumes</code> array holds the volume mappings for the service and supports named volumes, anonymous volumes, and bind mounts.</p>
<ul>
<li>The syntax is <code>&lt;source&gt;:&lt;destination&gt;</code> like you have seen before.</li>
</ul>
</li>
<li>
<p>The <code>environment</code> map holds the values of the various environment variables needed for the service.</p>
</li>
</ul>
<p>Definition code for the <code>api</code> service is as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">api:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context: ./api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dockerfile: Dockerfile.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: notes-api:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_name: notes-api-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DB_HOST: db ## same as the database service name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DB_DATABASE: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DB_PASSWORD: secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - ./api:/home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - 3000:3000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The <code>api</code> service doesn&#x27;t come with a pre-built image. Instead it has a <code>build</code> configuration. Under the build block we define the context and the name of the <code>Dockerfile</code> for building an image.</p>
</li>
<li>
<p>The <code>image</code> key holds the name of the image to be built. If not assigned, the image will be named following the <code>&lt;project directory name&gt;_&lt;service name&gt;</code> syntax.</p>
</li>
<li>
<p>Inside the <code>environment</code> map, we can refer to another service in the same application by using its name.</p>
<ul>
<li>So the <code>db</code> here, will be replaced by the IP address of the api service container.</li>
<li>The <strong>DB_DATABASE</strong> and <strong>DB_PASSWORD</strong> variables have to match up with <strong>POSTGRES_DB</strong> and <strong>POSTGRES_PASSWORD</strong> respectively from the db service definition.</li>
</ul>
</li>
<li>
<p>In the <code>volumes</code> map, you can see an anonymous volume and a bind mount described.</p>
</li>
<li>
<p>The <code>ports</code> map defines any port mapping. The syntax, <code>&lt;host port&gt;:&lt;container port&gt;</code> is identical to the <code>--publish</code> option you used before.</p>
</li>
</ul>
<p>Finally, the code for the <code>volumes</code> is as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db-data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: notes-db-dev-data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any named volume used in any of the services has to be defined here. If you don&#x27;t define a name, the volume will be named following the <code>&lt;project directory name&gt;_&lt;volume key&gt;</code> and the key here is <code>db-data</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="start-services">Start services<a href="#start-services" class="hash-link" aria-label="Direct link to Start services" title="Direct link to Start services">​</a></h2>
<p>You must your terminal in the same directory where the <code>docker-compose.yaml</code> file is.</p>
<p>The <code>up</code> command builds any missing images, creates containers, and starts them in one go.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose --file docker-compose.yaml up --detach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating network &quot;notes-api_default&quot; with the default driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating volume &quot;notes-db-dev-data&quot; with default driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Building api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sending build context to Docker daemon  37.38kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 1/13 : FROM node:lts-alpine as builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 471e8b4eb0b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 2/13 : RUN apk add --no-cache python make g++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 197056ec1964</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### LONG INSTALLATION STUFF GOES HERE ###</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 197056ec1964</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 6609935fe50b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 3/13 : WORKDIR /app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 17010f65c5e7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 17010f65c5e7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; b10d12e676ad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 4/13 : COPY ./package.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 600d31d9362e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 5/13 : RUN npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in a14afc8c0743</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### LONG INSTALLATION STUFF GOES HERE ###</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  Removing intermediate container a14afc8c0743</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 952d5d86e361</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 6/13 : FROM node:lts-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 471e8b4eb0b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 7/13 : ENV NODE_ENV=development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 0d5376a9e78a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 0d5376a9e78a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 910c081ce5f5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 8/13 : USER node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in cfaefceb1eff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container cfaefceb1eff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 1480176a1058</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 9/13 : RUN mkdir -p /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 3ae30e6fb8b8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 3ae30e6fb8b8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; c391cee4b92c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 10/13 : WORKDIR /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 6aa27f6b50c1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 6aa27f6b50c1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 761a7435dbca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 11/13 : COPY . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; b5d5c5bdf3a6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 12/13 : COPY --from=builder /app/node_modules /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 9e1a19960420</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 13/13 : CMD [ &quot;./node_modules/.bin/nodemon&quot;, &quot;--config&quot;, &quot;nodemon.json&quot;, &quot;bin/www&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 5bdd62236994</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 5bdd62236994</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 548e178f1386</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully built 548e178f1386</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully tagged notes-api:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-api-dev ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-db-dev  ... done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The <code>--detach</code> or <code>-d</code> option here to keep it running in background.</p>
</li>
<li>
<p>The <code>--file</code> or <code>-f</code> option is only needed if the YAML file is not named <code>docker-compose.yaml</code></p>
</li>
<li>
<p>The <code>--build</code> option for the up command forces a rebuild of the images.</p>
</li>
</ul>
<p>Apart from the the <code>up</code> command there is the <code>start</code> command. The main difference between these two is that the <code>start</code> command doesn&#x27;t create missing containers, only starts existing containers. It&#x27;s basically the same as the <code>container start</code> command.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="list-services">List services<a href="#list-services" class="hash-link" aria-label="Direct link to List services" title="Direct link to List services">​</a></h2>
<p><code>ps</code> command for listing containers defined in the YAML only.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     Name                   Command               State           Ports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev   docker-entrypoint.sh ./nod ...   Up      0.0.0.0:3000-&gt;3000/tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-db-dev    docker-entrypoint.sh postgres    Up      5432/tcp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execute-commands-inside-a-running-service">Execute commands inside a running service<a href="#execute-commands-inside-a-running-service" class="hash-link" aria-label="Direct link to Execute commands inside a running service" title="Direct link to Execute commands inside a running service">​</a></h2>
<p>Use the <code>exec</code> command to exec commands inside a running service.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose exec &lt;service name&gt; &lt;command&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To execute the <code>npm run db:migrate</code> command inside the <code>api</code> service, we can execute the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose exec api npm run db:migrate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &gt; notes-api@ db:migrate /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &gt; knex migrate:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using environment: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Batch 1 run: 1 migrations</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We don&#x27;t need to pass the <code>-it</code> flag for interactive sessions. docker-compose does that automatically.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="access-logs-from-a-running-service">Access logs from a running service<a href="#access-logs-from-a-running-service" class="hash-link" aria-label="Direct link to Access logs from a running service" title="Direct link to Access logs from a running service">​</a></h2>
<p>Use the <code>logs</code> command to retrieve logs from a running service.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose logs &lt;service name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To access the logs from the <code>api</code> service, execute the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose logs api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Attaching to notes-api-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] 2.0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] reading config ./nodemon.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] to restart at any time, enter `rs`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] or send SIGHUP to 1 to restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] ignoring: *.test.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] watching path(s): *.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] watching extensions: js,mjs,json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] starting `node bin/www`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] forking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] child pid: 19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | [nodemon] watching 18 files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># notes-api-dev | app running -&gt; http://127.0.0.1:3000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can kind of hook into the output stream of the service and get the logs in real-time by using the <code>-f</code> or <code>--follow</code> option</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stop-services">Stop services<a href="#stop-services" class="hash-link" aria-label="Direct link to Stop services" title="Direct link to Stop services">​</a></h2>
<p>The <code>down</code> command stops all running containers and removes them from the system.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose down --volumes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stopping notes-api-dev ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stopping notes-db-dev  ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing notes-api-dev ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing notes-db-dev  ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing network notes-api_default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing volume notes-db-dev-data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>--volumes</code> option indicates that you want to remove any named volume(s) defined in the <code>volumes</code> block.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compose-a-full-stack-application">Compose a full-stack application<a href="#compose-a-full-stack-application" class="hash-link" aria-label="Direct link to Compose a full-stack application" title="Direct link to Compose a full-stack application">​</a></h2>
<p><a href="https://www.freecodecamp.org/news/content/images/2021/01/fullstack-application-design.svg" target="_blank" rel="noopener noreferrer">Full-stack diagram</a></p>
<p>Let&#x27;s start writing the <code>docker-compose.yaml</code> file. Apart from the <code>api</code> and <code>db</code> services there will be the <code>client</code> and <code>nginx</code> services</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">docker-compose.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version: &quot;3.8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: postgres:12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-db-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - db-data:/var/lib/postgresql/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            POSTGRES_DB: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            POSTGRES_PASSWORD: secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context: ./api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dockerfile: Dockerfile.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: notes-api:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-api-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - ./api:/home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_HOST: db ## same as the database service name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_PORT: 5432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_USER: postgres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_DATABASE: notesdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DB_PASSWORD: secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context: ./client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dockerfile: Dockerfile.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: notes-client:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-client-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - ./client:/home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nginx:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context: ./nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dockerfile: Dockerfile.dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: notes-router:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name: notes-router-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        restart: unless-stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - 8080:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db-data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: notes-db-dev-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    frontend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: fullstack-notes-application-network-frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver: bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: fullstack-notes-application-network-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver: bridge</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s take a look at <code>networks</code> block:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    frontend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: fullstack-notes-application-network-frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver: bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: fullstack-notes-application-network-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver: bridge</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, Compose creates a bridge network and attaches all containers to that. In this project, however, I wanted proper network isolation. So I defined two networks, one for the front-end services and one for the back-end services.</p>
<p>I&#x27;ve also added networks block in each of the service definitions. This way the the api and db service will be attached to one network and the client service will be attached to a separate network. But the nginx service will be attached to both the networks so that it can perform as router between the front-end and back-end services.</p>
<p>Start all the <code>services</code> by executing the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose --file docker-compose.yaml up --detach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating network &quot;fullstack-notes-application-network-backend&quot; with driver &quot;bridge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating network &quot;fullstack-notes-application-network-frontend&quot; with driver &quot;bridge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating volume &quot;notes-db-dev-data&quot; with default driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Building api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sending build context to Docker daemon  37.38kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 1/13 : FROM node:lts-alpine as builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 471e8b4eb0b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 2/13 : RUN apk add --no-cache python make g++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in 8a4485388fd3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### LONG INSTALLATION STUFF GOES HERE ###</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container 8a4485388fd3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 47fb1ab07cc0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 3/13 : WORKDIR /app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in bc76cc41f1da</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container bc76cc41f1da</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 8c03fdb920f9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 4/13 : COPY ./package.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; a1d5715db999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 5/13 : RUN npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Running in fabd33cc0986</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### LONG INSTALLATION STUFF GOES HERE ###</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Removing intermediate container fabd33cc0986</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; e09913debbd1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 6/13 : FROM node:lts-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 471e8b4eb0b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 7/13 : ENV NODE_ENV=development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; b7c12361b3e5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 8/13 : USER node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; f5ac66ca07a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 9/13 : RUN mkdir -p /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 60094b9a6183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 10/13 : WORKDIR /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 316a252e6e3e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 11/13 : COPY . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 3a083622b753</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 12/13 : COPY --from=builder /app/node_modules /home/node/app/node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 707979b3371c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 13/13 : CMD [ &quot;./node_modules/.bin/nodemon&quot;, &quot;--config&quot;, &quot;nodemon.json&quot;, &quot;bin/www&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; f2da08a5f59b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully built f2da08a5f59b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully tagged notes-api:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Building client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sending build context to Docker daemon  43.01kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 1/7 : FROM node:lts-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 471e8b4eb0b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 2/7 : USER node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 4be5fb31f862</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 3/7 : RUN mkdir -p /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 1fefc7412723</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 4/7 : WORKDIR /home/node/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; d1470d878aa7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 5/7 : COPY ./package.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; bbcc49475077</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 6/7 : RUN npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 860a4a2af447</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 7/7 : CMD [ &quot;npm&quot;, &quot;run&quot;, &quot;serve&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 11db51d5bee7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully built 11db51d5bee7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully tagged notes-client:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Building nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sending build context to Docker daemon   5.12kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 1/2 : FROM nginx:stable-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; f2343e2e2507</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step 2/2 : COPY ./development.conf /etc/nginx/conf.d/default.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  ---&gt; 02a55d005a98</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully built 02a55d005a98</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Successfully tagged notes-router:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-client-dev ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-api-dev    ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-router-dev ... done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Creating notes-db-dev     ... done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<p><a href="https://www.freecodecamp.org/news/the-docker-handbook" target="_blank" rel="noopener noreferrer">Docker Handbook</a></p>
<p><a href="https://techmormo.com/posts/what-is-docker-compose/" target="_blank" rel="noopener noreferrer">What is Docker Compose - Techmormo</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xREMAGIx/renote/tree/main/docs/docker/docker-compose.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/renote/docs/docker/containerize-multi-js-app"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Containerize Multi-container JavaScript application</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/renote/docs/docker/docker-file"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dockerfile</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-features" class="table-of-contents__link toc-highlight">Key features</a></li><li><a href="#basics" class="table-of-contents__link toc-highlight">Basics</a></li><li><a href="#start-services" class="table-of-contents__link toc-highlight">Start services</a></li><li><a href="#list-services" class="table-of-contents__link toc-highlight">List services</a></li><li><a href="#execute-commands-inside-a-running-service" class="table-of-contents__link toc-highlight">Execute commands inside a running service</a></li><li><a href="#access-logs-from-a-running-service" class="table-of-contents__link toc-highlight">Access logs from a running service</a></li><li><a href="#stop-services" class="table-of-contents__link toc-highlight">Stop services</a></li><li><a href="#compose-a-full-stack-application" class="table-of-contents__link toc-highlight">Compose a full-stack application</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Notes</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/renote/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/renote/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 ReNote. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>